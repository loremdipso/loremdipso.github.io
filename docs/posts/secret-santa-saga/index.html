<!doctype html><html lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><title>Secret Santa: a Saga</title><meta content="Dive deep into my Secret Santa obsession" name=description><link href="/style.css?h=113f377b3ae52303efd1" integrity="sha256-ET83ezrlIwPv0VEg5Um8fx4qGJsUhKwPaUTyshbShXA=" crossorigin rel=stylesheet><link href="/post.css?h=618e029f323073604e10" integrity="sha256-YY4CnzIwc2BOEGNHgWXNaGjZyO9H+TjljQ/oWRSHwEg=" crossorigin rel=stylesheet><script src="/js/post-scroll.js?h=edfc3a547fcea064d0ad" async crossorigin></script><body><header class="app-header slide-in-from-top"><nav><a href=/>About</a><a class=active href=/posts/>Posts</a><a href=/minis/>Minis</a><a href=/projects/>Projects</a></nav><div class=socials><a rel="noopener me" href=https://www.linkedin.com/in/loremdipso/ target=_blank title=Linkedin> <span class=inline-svg> <svg viewbox="0 0 448 512" class=icon fill=#44bddc height=1em stroke=currentColor stroke-width=0 width=1em xmlns=http://www.w3.org/2000/svg><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg> </span> </a><a rel="noopener me" href=https://github.com/loremdipso target=_blank title=Github> <span class=inline-svg> <svg viewbox="0 0 496 512" class=icon fill=#44bddc height=1em stroke=currentColor stroke-width=0 width=1em xmlns=http://www.w3.org/2000/svg><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> </span> </a></div></header><div class=content-wrapper><div class=content><div class=progress-bar></div><main><article><header class=post-header><h1>Secret Santa: a Saga</h1><hr><div class=post-subheader><div class=post-metadata>Jan 27, 2022 · 7 minute read</div><div class=tags><a class=tag href=https://loremdipso.com/tags/one-shot/> <span class=inline-svg> <svg class="feather feather-tag meta-icon" viewbox="0 0 24 24" fill=none height=24 stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 width=24 xmlns=http://www.w3.org/2000/svg><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1=7 x2=7 y1=7 y2=7></line></svg> </span> one-shot </a><a class=tag href=https://loremdipso.com/tags/performance/> <span class=inline-svg> <svg class="feather feather-tag meta-icon" viewbox="0 0 24 24" fill=none height=24 stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 width=24 xmlns=http://www.w3.org/2000/svg><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1=7 x2=7 y1=7 y2=7></line></svg> </span> performance </a><a class=tag href=https://loremdipso.com/tags/svelte/> <span class=inline-svg> <svg class="feather feather-tag meta-icon" viewbox="0 0 24 24" fill=none height=24 stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 width=24 xmlns=http://www.w3.org/2000/svg><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1=7 x2=7 y1=7 y2=7></line></svg> </span> svelte </a></div></div><a href="https://github.com/loremdipso/loremdipso.github.io/issues/new?title=Issue with secret-santa-saga&body=I found an issue on page 'Secret Santa: a Saga'" class=feedback target=#>Found a mistake? Let me know!</a></header><div class=post-contents><div class=sidenav><aside class=toc-wrapper><div class=toc-title>Contents</div><ul><li><a href=#the-end-result>The End Result</a><li><a href=#backstory>Backstory</a><li><a href=#initial-approach>Initial Approach</a><li><a href=#existing-solutions>Existing Solutions</a><li><a href=#the-classic-excuse>The Classic Excuse</a><li><a href=#ui>UI</a><li><a href=#dev-experience>Dev Experience</a><li><a href=#bundle-size>Bundle Size</a><li><a href=#meanwhile-in-svelte-land>Meanwhile, in Svelte land</a><li><a href=#enter-smelte>Enter Smelte</a><li><a href=#caveats-and-conclusions>Caveats and Conclusions</a></ul></aside></div><p><picture><picture><img title="OMG IT'S SANTA!" alt=Santa! decoding=async height=552 loading=lazy src=/posts/secret-santa-saga/assets/santa.svg style=max-height:300px width=552></picture></picture><h2 id=the-end-result><a aria-label="Anchor link for: the-end-result" class=zola-anchor href=#the-end-result>The End Result</a></h2><p>Here ya go! <a rel="noopener nofollow noreferrer" href=https://loremdipso.com/secret-santa/ target=_blank>Secret Santa</a>.<h2 id=backstory><a aria-label="Anchor link for: backstory" class=zola-anchor href=#backstory>Backstory</a></h2><p>I have a groups of friends from college that have a <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Secret_Santa target=_blank>Secret Santa</a> event every year. Even after we all moved apart we've kept it up, jumping to Zoom to unwrap our gifts and guess who was our gifter. One of my most favorite traditions, a delight tempered only by the daunting task of logistics. You see, there are some constraints:<ol><li>Couples are already going to give each other gifts so they shouldn't be each other's Secret Santa<li>Secret Santa gifter/giftee pairs shouldn't be repeated (if possible). If not possible then we should prefer repeats that are as chronologically separate as possible. That is, a repeat from five years ago is much better than one from last year.<li>No one should know their Secret Santa, including the person doing the organizing.</ol><h2 id=initial-approach><a aria-label="Anchor link for: initial-approach" class=zola-anchor href=#initial-approach>Initial Approach</a></h2><p>At first I wrote a simple ruby script that would generate text files whose names were the gifter and whose contents were the giftee. The organizer would then send an email out to everyone, attaching the correct file to each email. This worked, but was relatively inflexible. Plus previous years didn't automatically carry over, so the organizer would have to manually update the ruby script with those pairings and prune old ones when there were too many for the script to find a valid solution.<h2 id=existing-solutions><a aria-label="Anchor link for: existing-solutions" class=zola-anchor href=#existing-solutions>Existing Solutions</a></h2><p>The closest thing I found out in the wild that didn't collect any info or show any ads was <a rel="noopener nofollow noreferrer" href=https://arcanis.github.io/secretsanta/ target=_blank>https://arcanis.github.io/secretsanta/</a>. It wasn't exactly what I was looking for, plus the exclusions seemed a bit broken, but it had the fantastic idea of encoding the giftee's information in the URL, using AES with a static key as an obfuscator. Neat!<h2 id=the-classic-excuse><a aria-label="Anchor link for: the-classic-excuse" class=zola-anchor href=#the-classic-excuse>The Classic Excuse</a></h2><p>If I'm being honest with myself I could have pretty easily extended the ruby script to do everything a web app could, but I'm always looking for any reason to try out a new technology. This time it was <a rel="noopener nofollow noreferrer" href=https://svelte.dev/ target=_blank>Svelte</a>. I'd heard it has Vue-like structure and Syntax, Vanilla JavaScript performance, and I'd already <a rel="noopener nofollow noreferrer" href=https://loremdipso.com/tags/lithe/ target=_blank>started writing a compiler for it</a>. So let's give a go, shall we?<h2 id=ui><a aria-label="Anchor link for: ui" class=zola-anchor href=#ui>UI</a></h2><p>The one thing anyone who uses Svelte seems willing to criticize is the lack of ecosystem. However I was able to find a <a rel="noopener nofollow noreferrer" href=https://sveltematerialui.com/ target=_blank>SMUI</a>, a Svelte implementation of <a rel="noopener nofollow noreferrer" href=https://material.io/ target=_blank>Material Design</a> that seemed reasonable enough.<h2 id=dev-experience><a aria-label="Anchor link for: dev-experience" class=zola-anchor href=#dev-experience>Dev Experience</a></h2><p>Here were some initial thoughts and minor complaints:<ol><li><p>Setup was easy enough with a good project template.</p><li><p>Webpack continues to be terribly complex, so for this project I finally gave <a rel="noopener nofollow noreferrer" href=https://rollupjs.org target=_blank>rollup</a> a shot. It kind of seemed like a Webpack with less historical baggage, which is exactly what I wanted.</p><li><p>Svelte's component-specific styles are very nice.</p><li><p>Svelte's hot reloading: also very nice</p><li><p>Wow, I really like those <code>$</code>. I've written enough using React's hooks that I'm never confident my code's going to be fast unless I memoize everything, so it's great to see something that just works.</p><li><p>At first Svelte's loud complaints about unused styles got on my nerves, but I've come to accept that they're probably for the best.</p><li><p>I don't think my app was complex enough to really take advantage of Svelte's proclaimed runtime performance benefits, but I have no complaints.</p><li><p>I noticed a couple of minor consistency issues. If I had a bug in a <code>.ts</code> file that wasn't used anywhere, and I renamed it so it was a <code>.txt</code> just to get rid of the errors, Rollup or Svelte or TSC or whoever should notice did not. I had to restart the dev server for it to see that change.</p></ol><h2 id=bundle-size><a aria-label="Anchor link for: bundle-size" class=zola-anchor href=#bundle-size>Bundle Size</a></h2><p>I was a little disappointed that the Svelte-based Material UI library spit out <strong>500 KB</strong> just in styles. I'd love to get rid of most of that, but even so the whole project comes in at under <strong>1 MB</strong> total. Okay, but how does it compare to, say, React? Well, luckily I first wrote this app using React and <a rel="noopener nofollow noreferrer" href=https://ant.design/ target=_blank>Antd</a>. The implementations aren't exactly the same but they have nearly the same set of features. All told, the build of the React version comes out at around <strong>3.4 MB</strong>, which seems awfully high to me, even for React. After some digging it turns out it was due to that version of antd having <a rel="noopener nofollow noreferrer" href=https://stackoverflow.com/questions/48721290/ant-design-huge-imports target=_blank>some issues</a>, so if I just <code>npm update</code> and rebuild I get...<p><strong>11 MB</strong> ?!?! Whoa whoa whoa, that can't be right. Alright, what if we use <a rel="noopener nofollow noreferrer" href=https://github.com/umijs/babel-plugin-import target=_blank>babel-plugin-import</a>, so that imports like <code>import { Button } from 'antd';</code> automatically turn into something more like <code>import Button from 'antd/lib/button';</code>. Apparently that's good for tree shaking. Aaaand... I actually kind of hate babel, so let's try and avoid it by just manually updating these imports. Aaaand...<p><strong>7.7 MB</strong>. Wellllll, that's... better, at least, but something's definitely squiffy. Alright, fine, I'll use babel. Aaaand... no change. Darn. Oh, wait! Looks like the real space-taker are <a rel="noopener nofollow noreferrer" href=https://github.com/ant-design/ant-design/issues/12011#issuecomment-623043192 target=_blank>the icons</a>, and we should use babel for that too. And with that I'm down to... <strong>4.8MB</strong>! <em>sigh</em> Alright, at this point I've had a gut full and just want to try something new.<h2 id=meanwhile-in-svelte-land><a aria-label="Anchor link for: meanwhile-in-svelte-land" class=zola-anchor href=#meanwhile-in-svelte-land>Meanwhile, in Svelte land</a></h2><p>So <strong>1 MB</strong>, huh? Alright, just in case I was doing something silly let's go ahead and just try to use a <a rel="noopener nofollow noreferrer" href=https://carbon-components-svelte.onrender.com/ target=_blank>similar UI library</a> in an app built using <a rel="noopener nofollow noreferrer" href=https://kit.svelte.dev/ target=_blank>Svelte Kit</a>'s starter app template. That should give me the latest and greatest setup. But no, that also ended up costing ~500KB in styles, base, before I even started to pull in components. Why am I paying for junk I'm not even using? Hopefully users of that lib have a way to cut those out, but for the life of me I haven't been able to find it.<h2 id=enter-smelte><a aria-label="Anchor link for: enter-smelte" class=zola-anchor href=#enter-smelte>Enter Smelte</a></h2><p><a rel="noopener nofollow noreferrer" href=https://smeltejs.com/ target=_blank>Smelte</a>. The elevator pitch is basically <a rel="noopener nofollow noreferrer" href=https://material.io/ target=_blank>Material Design</a> + <a rel="noopener nofollow noreferrer" href=https://tailwindcss.com/ target=_blank>Tailwind CSS</a>. You can use all of the normal Tailwind styles in your app plus a tonne of pre-built components. There was one outstanding issue where Smelte doesn't currently list a specific version of purgecss and is slightly incompatible with it. Hopefully that PR gets accepted soon, but until then I had great luck using an older version of <a rel="noopener nofollow noreferrer" href=https://www.npmjs.com/package/purgecss target=_blank>purgecss</a>.<p>So now that I've got my UI framework swapped out and patched up and worked like a dream, let's see the build size... <strong>200 KB</strong>!!! Alright, now that's more like it.<h2 id=caveats-and-conclusions><a aria-label="Anchor link for: caveats-and-conclusions" class=zola-anchor href=#caveats-and-conclusions>Caveats and Conclusions</a></h2><p>I should clarify that comparing the React+Carbon app against the Svelte+Smelte app isn't entirely fair. For one I just gave up on React+Carbon after a certain point. I'd hope that production apps aren't shipping with a framework that's got a <strong>4 MB</strong> "Hello World". Also, Carbon embeds its icons as SVG directly in its final bundle, whereas I reference Google Material Icons font library as an external URL. So to be more fair I should either increase the Svelte app's total size or decrease the React app's total size.<p>That said, I don't think I can definitively claim something as sweeping as "Svelte > React" or "Smelte > Carbon". What I can say is that testing performance is, as usual, important and <em>hard</em>. Even after deciding that bundle size was the metric I wanted to improve, actually going about improving it meant a lot of trial and error. I learned a lot, but if this project wasn't for fun I definitely wouldn't have put this much time or effort into it. And in the end I did find a combination of technologies that I'm really happy with that I'd love to try out in future projects, so I'll chalk this one up as smashing success.<p>Please tease me if I spend any more time re-writing this silly app again.<details><summary>Bonus: 2048</summary> <p>I did this same exercise with another of my old projects: <a href=https://loremdipso.com/YAN2048 target=#>YAN2048</a>. This one was written in Angular and only used its UI framework for the buttons and a game-over dialog. The <a href=https://loremdipso.com/YAN2048_Svelte target=#>clone</a> does the same, and I copy/pasted very nearly all the same logic and styles, yielding two very similar apps.</p> <h2>Results</h2> <p>On-disk space, Angular: an even <b>500 KB</b>, Svelte: <b>84 KB</b>.</p> <p>Total delivered to browser (according to my network tab), Angular: <b>587 KB</b> inflated (<b>251 KB</b> with gzip), Svelte: <b>224 KB</b> inflated (<b>179 KB</b> with gzip).</p> <p>But is this comparison worthwhile? Is what I observed experimentally vaguely in line with what they should be? Well, according to <a href=https://github.com/LayZeeDK/ngx-ivy-minimal-app-with-ngzone>this git repo</a>, a hello world using the <a href=https://docs.angular.lat/guide/ivy>Ivy renderer</a> costs around <b>131 KB</b> uncompressed. So, yeah, I think the results here are reasonable.</p></details></div></article><hr><div class=suggested-post-links><h3>Suggested reading</h3><a class=previous href=/posts/lithe-7> Previously: <b>Lithe 7 - Apples to Apples</b> </a><a class=next href=/posts/adding-interactivity> Up next: <b>Adding Interactivity</b> </a></div></main></div><footer class="app-footer fade-in"><p>© 2025  Michael Adams  <a href=/rss.xml target=_blank title=rss> <span class=inline-svg> <svg class="feather feather-rss" viewbox="0 0 24 24" fill=none height=24 stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 width=24 xmlns=http://www.w3.org/2000/svg><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx=5 cy=19 r=1></circle></svg> </span> </a></footer></div>