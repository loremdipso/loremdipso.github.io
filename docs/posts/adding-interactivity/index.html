<!doctype html><html lang=en><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><title>Adding Interactivity</title><meta content="Static sites are cool and all, but what about interactive demos???" name=description><link href="/style.css?h=113f377b3ae52303efd1" integrity="sha256-ET83ezrlIwPv0VEg5Um8fx4qGJsUhKwPaUTyshbShXA=" crossorigin rel=stylesheet><link href="/post.css?h=618e029f323073604e10" integrity="sha256-YY4CnzIwc2BOEGNHgWXNaGjZyO9H+TjljQ/oWRSHwEg=" crossorigin rel=stylesheet><script src="/js/post-scroll.js?h=edfc3a547fcea064d0ad" async crossorigin></script><body><header class="app-header slide-in-from-top"><nav><a href=/>About</a><a class=active href=/posts/>Posts</a><a href=/minis/>Minis</a><a href=/projects/>Projects</a></nav><div class=socials><a rel="noopener me" href=https://www.linkedin.com/in/loremdipso/ target=_blank title=Linkedin> <span class=inline-svg> <svg viewbox="0 0 448 512" class=icon fill=#44bddc height=1em stroke=currentColor stroke-width=0 width=1em xmlns=http://www.w3.org/2000/svg><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg> </span> </a><a rel="noopener me" href=https://github.com/loremdipso target=_blank title=Github> <span class=inline-svg> <svg viewbox="0 0 496 512" class=icon fill=#44bddc height=1em stroke=currentColor stroke-width=0 width=1em xmlns=http://www.w3.org/2000/svg><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> </span> </a></div></header><div class=content-wrapper><div class=content><div class=progress-bar></div><main><article><header class=post-header><h1>Adding Interactivity</h1><hr><div class=post-subheader><div class=post-metadata>Dec 24, 2022 Â· 3 minute read</div><div class=tags><a class=tag href=https://loremdipso.com/tags/mini/> <span class=inline-svg> <svg class="feather feather-tag meta-icon" viewbox="0 0 24 24" fill=none height=24 stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 width=24 xmlns=http://www.w3.org/2000/svg><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1=7 x2=7 y1=7 y2=7></line></svg> </span> mini </a><a class=tag href=https://loremdipso.com/tags/software/> <span class=inline-svg> <svg class="feather feather-tag meta-icon" viewbox="0 0 24 24" fill=none height=24 stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 width=24 xmlns=http://www.w3.org/2000/svg><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1=7 x2=7 y1=7 y2=7></line></svg> </span> software </a><a class=tag href=https://loremdipso.com/tags/svelte/> <span class=inline-svg> <svg class="feather feather-tag meta-icon" viewbox="0 0 24 24" fill=none height=24 stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 width=24 xmlns=http://www.w3.org/2000/svg><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1=7 x2=7 y1=7 y2=7></line></svg> </span> svelte </a></div></div><a href="https://github.com/loremdipso/loremdipso.github.io/issues/new?title=Issue with adding-interactivity&body=I found an issue on page 'Adding Interactivity'" class=feedback target=#>Found a mistake? Let me know!</a></header><div class=post-contents><div class=sidenav><aside class=toc-wrapper><div class=toc-title>Contents</div><ul><li><a href=#looking-for-problems-to-solve>Looking For Problems To Solve</a><li><a href=#creating-the-bundle>Creating the Bundle</a><li><a href=#embedding-the-bundle>Embedding the Bundle</a><li><a href=#automation>Automation</a><li><a href=#styles>Styles</a></ul></aside></div><h2 id=looking-for-problems-to-solve><a aria-label="Anchor link for: looking-for-problems-to-solve" class=zola-anchor href=#looking-for-problems-to-solve>Looking For Problems To Solve</a></h2><p><a rel="noopener nofollow noreferrer" href=https://www.getzola.org/ target=_blank>Zola</a> is wonderful. It builds quickly, it's extremely configurable, but it is (by design) not well suited for interactive elements or complex <code>JavaScript</code>. I hadn't thought I wanted that until I saw some on <a rel="noopener nofollow noreferrer" href=https://fasterthanli.me/ target=_blank>Amos's site</a>. He ended up using <code>iframes</code> to manage that integration, which is a perfectly acceptable solution. But it did make me wonder: can we accomplish the same result without all of that nasty ugly <code>HTML</code>? Can we just write some clean <code>JS</code> and call it a day?<p>Let's find out.<h2 id=creating-the-bundle><a aria-label="Anchor link for: creating-the-bundle" class=zola-anchor href=#creating-the-bundle>Creating the Bundle</a></h2><p>I hear that <a rel="noopener nofollow noreferrer" href=https://svelte.dev/ target=_blank>Svelte</a> is great at integrating into existing applications. You just give it some home in the <code>DOM</code> as an argument and away it goes:<pre class=language-ts data-lang=ts style=color:#cccece;background-color:#2b2c2f><code class=language-ts data-lang=ts><span style=color:#c594c5>import </span><span>Counter </span><span style=color:#c594c5>from </span><span style=color:#5fb3b3>"</span><span style=color:#99c794>./demos/Counter.svelte</span><span style=color:#5fb3b3>";
</span><span>
</span><span style=color:#c594c5>const </span><span>app </span><span style=color:#5fb3b3>= new </span><span>Counter(</span><span style=color:#5fb3b3>{
</span><span>	target</span><span style=color:#5fb3b3>: </span><span style=color:#69c>document</span><span style=color:#5fb3b3>.</span><span style=color:#69c>getElementById</span><span>(</span><span style=color:#5fb3b3>"</span><span style=color:#99c794>counter</span><span style=color:#5fb3b3>"</span><span>)</span><span style=color:#5fb3b3>,
</span><span style=color:#5fb3b3>}</span><span>)</span><span style=color:#5fb3b3>;
</span><span>
</span><span style=color:#c594c5>export default </span><span>app</span><span style=color:#5fb3b3>;
</span></code></pre><p>Let's make the classic simple counter for our test:<pre class=language-html data-lang=html style=color:#cccece;background-color:#2b2c2f><code class=language-html data-lang=html><span style=color:#5fb3b3>&lt;</span><span style=color:#eb606b>script </span><span style=color:#bb80b3>lang</span><span style=color:#5fb3b3>="</span><span style=color:#99c794>ts</span><span style=color:#5fb3b3>">
</span><span>	</span><span style=color:#c594c5>let </span><span>count: number </span><span style=color:#5fb3b3>= </span><span style=color:#f99157>0</span><span style=color:#5fb3b3>;
</span><span>	</span><span style=color:#c594c5>const </span><span>increment </span><span style=color:#5fb3b3>= () </span><span style=color:#c594c5>=> </span><span style=color:#5fb3b3>{
</span><span>		count </span><span style=color:#5fb3b3>+= </span><span style=color:#f99157>1</span><span style=color:#5fb3b3>;
</span><span>	</span><span style=color:#5fb3b3>};
</span><span style=color:#5fb3b3>&lt;/</span><span style=color:#eb606b>script</span><span style=color:#5fb3b3>>
</span><span>
</span><span style=color:#5fb3b3>&lt;</span><span style=color:#eb606b>main</span><span style=color:#5fb3b3>>
</span><span>	</span><span style=color:#5fb3b3>&lt;</span><span style=color:#eb606b>button </span><span style=color:#bb80b3>on:click</span><span style=color:#5fb3b3>="</span><span style=color:#99c794>{increment}</span><span style=color:#5fb3b3>"></span><span>Clicked {count} times</span><span style=color:#5fb3b3>&lt;/</span><span style=color:#eb606b>button</span><span style=color:#5fb3b3>>
</span><span style=color:#5fb3b3>&lt;/</span><span style=color:#eb606b>main</span><span style=color:#5fb3b3>>
</span></code></pre><p>We're using <a rel="noopener nofollow noreferrer" href=https://vitejs.dev/ target=_blank>Vite</a> to build, and we'd like a separate JS bundle for each demo. As of version 3.2 we can use multiple lib entry points, like so:<pre class=language-ts data-lang=ts style=color:#cccece;background-color:#2b2c2f><code class=language-ts data-lang=ts><span style=color:#c594c5>export default </span><span style=color:#69c>defineConfig</span><span>(</span><span style=color:#5fb3b3>({ </span><span style=color:#f99157>command </span><span style=color:#5fb3b3>}) </span><span style=color:#c594c5>=> </span><span>(</span><span style=color:#5fb3b3>{
</span><span>	plugins</span><span style=color:#5fb3b3>: </span><span>[</span><span style=color:#69c>svelte</span><span>()]</span><span style=color:#5fb3b3>,
</span><span>
</span><span style=color:#5fb3b3>	</span><span style=color:#5f6364>// Use a temporary directory to not much up our release
</span><span>	cacheDir</span><span style=color:#5fb3b3>: "</span><span style=color:#99c794>temp</span><span style=color:#5fb3b3>",
</span><span>
</span><span>	build</span><span style=color:#5fb3b3>: {
</span><span style=color:#5fb3b3>		</span><span style=color:#5f6364>// Build to a common location accessible to Zola
</span><span>		outDir</span><span style=color:#5fb3b3>: "</span><span style=color:#99c794>../static/demos</span><span style=color:#5fb3b3>",
</span><span>
</span><span>		sourcemap</span><span style=color:#5fb3b3>: </span><span>command </span><span style=color:#5fb3b3>=== "</span><span style=color:#99c794>serve</span><span style=color:#5fb3b3>",
</span><span>		minify</span><span style=color:#5fb3b3>: "</span><span style=color:#99c794>esbuild</span><span style=color:#5fb3b3>",
</span><span>		lib</span><span style=color:#5fb3b3>: {
</span><span>			entry</span><span style=color:#5fb3b3>: {
</span><span>				counter</span><span style=color:#5fb3b3>: "</span><span style=color:#99c794>./src/counter.ts</span><span style=color:#5fb3b3>",
</span><span>			</span><span style=color:#5fb3b3>},
</span><span>			formats</span><span style=color:#5fb3b3>: </span><span>[</span><span style=color:#5fb3b3>"</span><span style=color:#99c794>es</span><span style=color:#5fb3b3>"</span><span>]</span><span style=color:#5fb3b3>,
</span><span>		</span><span style=color:#5fb3b3>},
</span><span>	</span><span style=color:#5fb3b3>},
</span><span style=color:#5fb3b3>}</span><span>))</span><span style=color:#5fb3b3>;
</span></code></pre><p>While we're at it I'd like to have a test page to test out some of these demos, and that list of entries would be useful there, so let's extract that out:<pre class=language-ts data-lang=ts style=color:#cccece;background-color:#2b2c2f><code class=language-ts data-lang=ts><span style=color:#c594c5>export const </span><span>demos </span><span style=color:#5fb3b3>= {
</span><span>	counter</span><span style=color:#5fb3b3>: "</span><span style=color:#99c794>./src/counter.ts</span><span style=color:#5fb3b3>",
</span><span style=color:#5fb3b3>};
</span></code></pre><h2 id=embedding-the-bundle><a aria-label="Anchor link for: embedding-the-bundle" class=zola-anchor href=#embedding-the-bundle>Embedding the Bundle</a></h2><p>On the Zola side of things we can use a <a rel="noopener nofollow noreferrer" href=https://www.getzola.org/documentation/content/shortcodes/ target=_blank>shortcode</a> to do our dirty work. So if we say our shortcode lives in <code>demo.html</code> and looks like this (forgive the messy <a rel="noopener nofollow noreferrer" href=https://tera.netlify.app/ target=_blank>Tera</a> code):<pre class=language-html data-lang=html style=color:#cccece;background-color:#2b2c2f><code class=language-html data-lang=html><span style=color:#5fb3b3>&lt;</span><span style=color:#eb606b>div </span><span style=color:#bb80b3>class</span><span style=color:#5fb3b3>="</span><span style=color:#99c794>demo</span><span style=color:#5fb3b3>">
</span><span>	{%- set js_path = "/demos/" ~ key ~ ".js" -%} {%- set js_path =
</span><span>	get_url(path=js_path, trailing_slash=false, cachebust=true) -%} {%- set
</span><span>	js_path = js_path | replace(from=config.base_url, to="") -%}
</span><span>
</span><span>	</span><span style=color:#5fb3b3>&lt;</span><span style=color:#eb606b>script </span><span style=color:#bb80b3>src</span><span style=color:#5fb3b3>="</span><span style=color:#99c794>{% js_path %}</span><span style=color:#5fb3b3>" </span><span style=color:#bb80b3>type</span><span style=color:#5fb3b3>="</span><span style=color:#99c794>module</span><span style=color:#5fb3b3>" </span><span style=color:#bb80b3>crossorigin</span><span style=color:#5fb3b3>="</span><span style=color:#99c794>anonymous</span><span style=color:#5fb3b3>">&lt;/</span><span style=color:#eb606b>script</span><span style=color:#5fb3b3>>
</span><span>	</span><span style=color:#5fb3b3>&lt;</span><span style=color:#eb606b>div </span><span style=color:#bb80b3>id</span><span style=color:#5fb3b3>="</span><span style=color:#99c794>{{ key }}</span><span style=color:#5fb3b3>">&lt;/</span><span style=color:#eb606b>div</span><span style=color:#5fb3b3>>
</span><span style=color:#5fb3b3>&lt;/</span><span style=color:#eb606b>div</span><span style=color:#5fb3b3>>
</span></code></pre><p>Then to use in markdown we could do something like:<pre class=language-md data-lang=md style=color:#cccece;background-color:#2b2c2f><code class=language-md data-lang=md><span>Will this work? Let's see: {{ demo(key="counter") }}
</span></code></pre><p>Will this work? Let's see:<div class=demo><script src="/demos/counter.js?h=7136e20ee0e9414cf8d0" async crossorigin type=module></script><div id=counter></div></div><p>Et voilÃ ! ð¥³<h2 id=automation><a aria-label="Anchor link for: automation" class=zola-anchor href=#automation>Automation</a></h2><p>It's a bit unfortunate that to make a new demo I need to manually:<ol><li>Modify an object<li>Create a shell <code>.ts</code> file to bootstrap the demo<li>Create the actual demo</ol><p>It'd be a bit cleaner to do away with the shell <code>.ts</code> file entirely (perhaps by generating it during build time?) but it's a bit easier to keep these steps explicit for now and just add a script to automate them. This smells like a premature workflow automation trap and I'm not falling for it this time. I swear! Look, if I make like 10 more demos then <em>maybe</em> I'll look into this, but not until then.<h2 id=styles><a aria-label="Anchor link for: styles" class=zola-anchor href=#styles>Styles</a></h2><p>The way Svelte handles styles is quite interesting<sup class=footnote-reference id=fr-1-1><a href=#fn-1>1</a></sup> but for our purposes are not ideal. We either need to export a separate <code>css</code> file per entrypoint and explicitly include it with our shortcode or else pretend it's <a rel="noopener nofollow noreferrer" href=https://levelup.gitconnected.com/a-brief-history-of-css-in-js-how-we-got-here-and-where-were-going-ea6261c19f04 target=_blank>1994</a> and use <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/CSS-in-JS target=_blank>CSS-in-JS</a>. OR we lean on the lovely <a rel="noopener nofollow noreferrer" href=https://www.npmjs.com/package/vite-plugin-css-injected-by-js target=_blank>vite-plugin-css-injected-by-js</a> package to do that for us. We simply need to add it to our vite config like so:<pre class=language-ts data-lang=ts style=color:#cccece;background-color:#2b2c2f><code class=language-ts data-lang=ts><span style=color:#c594c5>export default </span><span style=color:#69c>defineConfig</span><span>(</span><span style=color:#5fb3b3>({ </span><span style=color:#f99157>command </span><span style=color:#5fb3b3>}) </span><span style=color:#c594c5>=> </span><span>(</span><span style=color:#5fb3b3>{
</span><span>	plugins</span><span style=color:#5fb3b3>: </span><span>[</span><span style=color:#69c>svelte</span><span>()</span><span style=color:#5fb3b3>, </span><span style=color:#69c>cssInjectedByJsPlugin</span><span>()]</span><span style=color:#5fb3b3>,
</span><span style=color:#5fb3b3>	</span><span style=color:#5f6364>// ...cut
</span><span style=color:#5fb3b3>}</span><span>);
</span></code></pre><p>And it'll muck around in our JS bundle and have it insert styles directly into the page's header. Generally not a practice I like, but for our single-file demos this is just about perfect. I say just about since by default in a multi-output project this plugin just sort of picks one. To remedy this we simply need to provide a <code>jsAssetsFilterFunction</code> and we'll just have it return true:<pre class=language-ts data-lang=ts style=color:#cccece;background-color:#2b2c2f><code class=language-ts data-lang=ts><span style=color:#69c>cssInjectedByJsPlugin</span><span>(</span><span style=color:#5fb3b3>{
</span><span>	</span><span style=color:#69c>jsAssetsFilterFunction</span><span style=color:#5fb3b3>: () </span><span style=color:#c594c5>=> </span><span style=color:#5fb3b3>{
</span><span>		</span><span style=color:#c594c5>return </span><span style=color:#f99157>true</span><span style=color:#5fb3b3>;
</span><span>	</span><span style=color:#5fb3b3>},
</span><span style=color:#5fb3b3>}</span><span>)</span><span style=color:#5fb3b3>,
</span></code></pre><p>That's it for now, hope you enjoyed. Come back soon!<section class=footnotes><ol class=footnotes-list><li id=fn-1><p>Basically svelte does something sort of similar to how Angular does <a rel="noopener nofollow noreferrer" href=https://angular.io/guide/view-encapsulation target=_blank>component styles</a> but instead of using the <a rel="noopener nofollow noreferrer" href=https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_shadow_DOM target=_blank>Shadow DOM</a> svelte basically converts classnames into unique-enough tokens to prevent collisions. So a <code>.container</code> might become <code>.container-svelteapp123</code>, though in practice it's a much shorter string. <a href=#fr-1-1>â©</a></p></ol></section></div></article><hr><div class=suggested-post-links><h3>Suggested reading</h3><a class=previous href=/posts/secret-santa-saga> Previously: <b>Secret Santa: a Saga</b> </a><a class=next href=/posts/wait-should-i-start-a-linkblog> Up next: <b>Wait, should I start a link-blog too??</b> </a></div></main></div><footer class="app-footer fade-in"><p>Â© 2025 Â Michael AdamsÂ  <a href=/rss.xml target=_blank title=rss> <span class=inline-svg> <svg class="feather feather-rss" viewbox="0 0 24 24" fill=none height=24 stroke=currentColor stroke-linecap=round stroke-linejoin=round stroke-width=2 width=24 xmlns=http://www.w3.org/2000/svg><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx=5 cy=19 r=1></circle></svg> </span> </a></footer></div>